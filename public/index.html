<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>云南行无忧客户数据分析</title>
    <link rel="stylesheet" type="text/css" href="./styles/iview.css">
    <script type="text/javascript" src="./vue.min.js"></script>
    <script type="text/javascript" src="./iview.min.js"></script>
    <script type="text/javascript" src="./axios.min.js"></script>
</head>

<body>
    <div id="app">
        <Upload multiple type="drag" action="./upload" name="excel" :on-success="uploadSuccess">
            <div style="padding: 20px 0">
                <Icon type="ios-cloud-upload" size="52" style="color: #3399ff"></Icon>
                <p>{{text1}}</p>
            </div>
        </Upload>
        <Tag v-for="item in counts" :key="item[1]" :name="item" closable @on-close="handleClose2">{{ item[1] }}</Tag>
        <i-button @click="show">查看数据</i-button>
        <div v-for="(buttons, index) in buttonss" :key="buttons" v-show="!visible[index]" style="display:flex;align-items:baseline;height:25px">
            <span>{{buttons.title}}</span>
            <div>
                <i-button v-for="item in buttons.buttons" :key="item" type="text" @click="handleAddTag(item, index)">{{item}}
                </i-button>
            </div>
          <!-- <Divider dashed /> -->
        </div>
        <i-table :columns="columns10" :data="data10" width="500" height="200"></i-table>
        <Page :total="totalColumns" @on-change="handlePageChange"></Page>
    </div>

    <script>
        let totalColumns = 0;

        new Vue({
            el: '#app',
            data: {
                totalColumns: 0,
                visible: [],
                text1: "请点击或把文件拖到这里。。。",
                columns10: [{
                        title: '用户姓名',
                        key: '用户姓名',
                        width: 100,
                        fixed: "left"
                    },
                    {
                        title: '用户手机',
                        key: '用户手机',
                        width: 200
                    },
                    {
                        title: '车牌号',
                        key: '车牌号',
                        width: 300
                    }
                ],
                data10: [],
                counts: [],// [[0, "三个月未进厂"], [1, "女性"], [2, "昂克赛拉"]],\
                buttonss: [{
                    title: "购车时间",
                    buttons: ["111", "222", "3333",  "三个月未进厂"]
                }, {
                    title: "性别",
                    buttons: ["男", "女"]
                },
                {
                    title: "车系",
                    buttons: ["昂克赛拉", "CX5", "CX3"]
                }]
            },
            methods: {
                handlePageChange: function(page){
                    console.log(page)
                    let c = totalColumns.concat();
                    this.data10 = c.splice((page-1)*10, 10);
                },
                handleAddTag: function (tag, index) {
                    console.log(tag, " ", index);
                    this.counts.push([index, tag]);
                    this.visible[index] = true;
                },
                show: function () {
                    axios.get('./get-table').then(res => {
                        //console.log(res.data.length);
                        totalColumns = res.data.concat();
                        this.totalColumns = totalColumns.length;
                        this.data10 = res.data.splice(0,10);
                    })
                },
                uploadSuccess: function (response, file, fileList) {
                    console.log(response);
                    this.text1 = "文件上传成功";
                },
                handleClose2(event, tag) {
                    console.log(tag);
                    const index = this.counts.indexOf(tag);
                    this.counts.splice(index, 1);

                    this.visible[tag[0]] = false;
                }
            }
        })
    </script>

    <style>
        .aaa {
            padding: 0px;
            margin: 0px;
            height: 25px;
            width: 500px;
            border: 1px;
        }
    </style>
</body>

</html>